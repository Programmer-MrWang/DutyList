<ci:SettingsPageBase
    x:Class="DutyListPlugin.Settings.DutySettingsPage"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ci="clr-namespace:ClassIsland.Core.Abstractions.Controls;assembly=ClassIsland.Core"
    xmlns:models="clr-namespace:DutyListPlugin.Models"
    xmlns:conv="clr-namespace:DutyListPlugin.Converters">

  <ci:SettingsPageBase.Resources>
    <conv:StringToColorConverter x:Key="StringToColor"/>
  </ci:SettingsPageBase.Resources>

  <ci:SettingsPageBase.Content>
    <ScrollViewer>
      <StackPanel Margin="16" Spacing="8">

        <TextBlock Text="é€‰æ‹©æ˜ŸæœŸ" FontSize="15" FontWeight="Bold"/>
        <ComboBox Name="WeekSelector"
                  Width="160"
                  HorizontalAlignment="Left"
                  SelectionChanged="OnWeekChanged"/>

        <ItemsControl Name="TimeSlotList">
          <ItemsControl.ItemTemplate>
            <DataTemplate DataType="{x:Type models:DutyTimeSlot}">
              <Border BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4"
                      Padding="12" Margin="0,0,0,12">
                <StackPanel Spacing="6">

                  <!-- æ—¶é—´æ®µæ ‡é¢˜è¡Œ -->
                  <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="å¼€å§‹ï¼š" VerticalAlignment="Center"/>
                    <TextBox Width="70" Text="{Binding StartText}" Watermark="08:00"/>
                    <TextBlock Text="ç»“æŸï¼š" VerticalAlignment="Center"/>
                    <TextBox Width="70" Text="{Binding EndText}"   Watermark="12:00"/>
                    <Button Content="åˆ é™¤æ—¶é—´æ®µ"
                            Foreground="Red"
                            Tag="{Binding}"
                            Click="RemoveTimeSlot"/>
                  </StackPanel>

                  <!-- é¡¹ç›®åˆ—è¡¨ -->
                  <ItemsControl ItemsSource="{Binding Items}">
                    <ItemsControl.ItemTemplate>
                      <DataTemplate DataType="{x:Type models:DutyItem}">
                        <StackPanel Spacing="4" Margin="0,3">

                          <!-- ç¬¬ä¸€è¡Œï¼šé¡¹ç›®å + äººå‘˜ -->
                          <StackPanel Orientation="Horizontal" Spacing="4">
                            <TextBox Width="100" Text="{Binding Project}" Watermark="é¡¹ç›®åç§°"/>
                            <TextBox Width="68"  Text="{Binding Person1}" Watermark="äººå‘˜1"/>
                            <TextBox Width="68"  Text="{Binding Person2}" Watermark="äººå‘˜2"/>
                            <TextBox Width="68"  Text="{Binding Person3}" Watermark="äººå‘˜3"/>
                            <Button Content="âœ•" Tag="{Binding}" Click="RemoveItem" Margin="4,0,0,0"/>
                          </StackPanel>

                          <!-- ç¬¬äºŒè¡Œï¼šé¢œè‰²é€‰å–é¢æ¿ -->
                          <StackPanel Orientation="Horizontal" Spacing="6">
                            <TextBlock Text="é¡¹ç›®é¢œè‰²ï¼š" VerticalAlignment="Center" FontSize="12"/>
                            <!-- ColorPickerï¼šä¸‹æ‹‰å¼æ‹¾è‰²å™¨ï¼Œç‚¹å‡»è‰²å—å±•å¼€å®Œæ•´é€‰è‰²é¢æ¿ -->
                            <ColorPicker
                                Color="{Binding Color, Converter={StaticResource StringToColor}, Mode=TwoWay}"
                                IsAlphaEnabled="False"
                                HorizontalAlignment="Left"/>
                          </StackPanel>

                        </StackPanel>
                      </DataTemplate>
                    </ItemsControl.ItemTemplate>
                  </ItemsControl>

                  <Button Content="ï¼‹ æ·»åŠ é¡¹ç›®"
                          HorizontalAlignment="Left"
                          Tag="{Binding}"
                          Click="AddItem"/>

                </StackPanel>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>

        <StackPanel Orientation="Horizontal" Spacing="8">
          <Button Content="ï¼‹ æ·»åŠ æ—¶é—´æ®µ" Click="AddTimeSlot"/>
          <Button Content="ðŸ’¾ ä¿å­˜é…ç½®"   Click="Save"/>
        </StackPanel>

      </StackPanel>
    </ScrollViewer>
  </ci:SettingsPageBase.Content>

</ci:SettingsPageBase>
